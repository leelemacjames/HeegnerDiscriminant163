<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heegner Number & Prime Polynomial Explorer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- MathJax for LaTeX Rendering -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        .prime-cell { background-color: #dcfce7; color: #166534; font-weight: bold; }
        .composite-cell { background-color: #fee2e2; color: #991b1b; }
        .heegner-highlight { background-color: #f0f9ff; border-left: 4px solid #0ea5e9; }
        /* Smooth scrolling for the table container */
        .table-scroll {
            scrollbar-width: thin;
            scrollbar-color: #cbd5e1 #f8fafc;
        }
        /* Fix for sticky column alignment */
        .sticky-col-1 { position: sticky; left: 0; z-index: 30; }
        .sticky-col-2 { position: sticky; left: 100px; z-index: 30; }
    </style>
</head>
<body class="bg-slate-50 min-height-screen p-4 md:p-8">
    <div class="max-w-7xl mx-auto">
        <header class="mb-8 text-center">
            <h1 class="text-3xl font-bold text-slate-800 mb-2">Heegner Number Matrix Explorer</h1>
            <p class="text-slate-600">Investigating the Prime-Generating Polynomial: \(f(n) = n^2 - n + \frac{1+D}{4}\)
            , LeeMcCullochJames@</p>
        </header>

        <!-- Controls -->
        <div class="bg-white p-6 rounded-xl shadow-sm mb-8 flex flex-wrap gap-6 items-center justify-center border border-slate-200">
            <div class="flex flex-col">
                <label class="text-sm font-semibold text-slate-700 mb-1">Max \(n\) (Columns):</label>
                <input type="range" id="nRange" min="5" max="50" value="45" class="w-64 accent-blue-600">
                <span id="nValue" class="text-center font-mono text-blue-600 font-bold text-lg">45</span>
            </div>
            <div class="text-sm text-slate-500 max-w-md border-l pl-6 border-slate-200">
                <p>Observe the "163" row: It produces a solid streak of primes until \(n=41\). </p>
                <div class="mt-2 flex gap-4">
                    <span><span class="inline-block w-3 h-3 bg-green-100 border border-green-300 mr-1"></span> Prime</span>
                    <span><span class="inline-block w-3 h-3 bg-red-100 border border-red-300 mr-1"></span> Composite</span>
                </div>
            </div>
        </div>

        <!-- Table Container -->
        <div class="overflow-x-auto bg-white rounded-xl shadow-md border border-slate-200 table-scroll">
            <table class="w-full text-sm text-left border-collapse">
                <thead>
                    <tr id="tableHeader" class="bg-slate-100 border-b border-slate-200">
                        <!-- Populated by JS -->
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- Populated by JS -->
                </tbody>
            </table>
        </div>

        <!-- Explanation Section -->
        <div class="grid md:grid-cols-2 gap-8 mt-12">
            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                <h2 class="text-xl font-bold text-slate-800 mb-4">The Mathematical Significance</h2>
                <p class="text-slate-600 mb-4">
                    A <strong>Heegner number</strong> is a positive square-free integer \(D\) such that the imaginary quadratic field \(\mathbb{Q}(\sqrt{-D})\) has class number 1. 
                    This property is extremely rare; there are exactly nine: 
                    <span class="font-mono bg-slate-100 px-1 rounded text-blue-700">1, 2, 3, 7, 11, 19, 43, 67, 163</span>.
                </p>
                <p class="text-slate-600">
                    For \(D=163\), the constant \(\frac{1+163}{4} = 41\). 
                    The resulting polynomial \(n^2 - n + 41\) is famous for producing primes for \(n=1\) up to \(n=40\). At \(n=41\), the formula becomes \(41^2 - 41 + 41 = 41^2 = 1681\), which is obviously composite.
                </p>
            </div>
            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                <h2 class="text-xl font-bold text-slate-800 mb-4">Observations</h2>
                <ul class="space-y-3 text-slate-600">
                    <li><strong class="text-slate-800">The "Break" Point:</strong> Slide the range to 50. Notice how row 163 turns <span class="text-red-600 font-bold">red</span> exactly at column 41.</li>
                    <li><strong class="text-slate-800">Half-Integers:</strong> For \(D=1\) and \(D=2\), the constant is not an integer. These rows show the decimal results and are generally not prime-generating in this form.</li>
                    <li><strong class="text-slate-800">Class Number 1:</strong> These numbers are the only ones that allow this specific type of prime-generating "perfection" due to the unique factorization in their associated rings of integers.</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        const heegnerNumbers = [1, 2, 3, 7, 11, 19, 43, 67, 163];
        
        function isPrime(num) {
            if (num <= 1) return false;
            if (num % 1 !== 0) return false;
            for (let i = 2; i <= Math.sqrt(num); i++) {
                if (num % i === 0) return false;
            }
            return true;
        }

        function updateTable() {
            const maxN = parseInt(document.getElementById('nRange').value);
            document.getElementById('nValue').textContent = maxN;

            const headerRow = document.getElementById('tableHeader');
            const tableBody = document.getElementById('tableBody');

            // Using ASCII/Unicode for the fraction to ensure clean display without LaTeX errors
            const fractionHeader = "Const (1+D)/4";

            // Build Header
            headerRow.innerHTML = `
                <th class="p-4 border-r border-slate-200 sticky left-0 bg-slate-100 z-30 min-w-[100px]">Heegner \(D\)</th>
                <th class="p-4 border-r border-slate-200 sticky left-[100px] bg-slate-100 z-30 min-w-[140px]">${fractionHeader}</th>
                ${Array.from({length: maxN}, (_, i) => `<th class="p-2 text-center border-r border-slate-200 min-w-[60px]">\(n=${i+1}\)</th>`).join('')}
            `;

            // Build Body
            tableBody.innerHTML = '';
            heegnerNumbers.forEach(d => {
                const constant = (1 + d) / 4;
                const row = document.createElement('tr');
                row.className = "border-b border-slate-100 hover:bg-slate-50 transition-colors group";
                
                let cellsHtml = `
                    <td class="p-4 font-bold text-slate-700 border-r border-slate-200 sticky left-0 bg-white group-hover:bg-slate-50 z-20">${d}</td>
                    <td class="p-4 font-mono text-slate-500 border-r border-slate-200 sticky left-[100px] bg-white group-hover:bg-slate-50 z-20">${constant}</td>
                `;

                for (let n = 1; n <= maxN; n++) {
                    const val = (n * n) - n + constant;
                    const isP = isPrime(val);
                    const isInt = (val % 1 === 0);
                    
                    let cellClass = "";
                    if (isInt) {
                        cellClass = isP ? 'prime-cell' : 'composite-cell';
                    } else {
                        cellClass = 'text-slate-400 italic bg-slate-50';
                    }
                    
                    cellsHtml += `<td class="p-2 text-center border-r border-slate-100 ${cellClass}">${val}</td>`;
                }

                row.innerHTML = cellsHtml;
                tableBody.appendChild(row);
            });

            // Re-render LaTeX for the rest of the page
            if (window.MathJax) {
                MathJax.typesetPromise();
            }
        }

        document.getElementById('nRange').addEventListener('input', updateTable);
        
        // Initial load
        window.onload = updateTable;
    </script>
</body>
</html>
